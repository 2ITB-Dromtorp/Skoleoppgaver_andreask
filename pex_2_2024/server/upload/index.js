const l=require("fs"),t=require("path"),o=require("dotenv"),e=require("mongodb"),c=(o.config(),new e.MongoClient(process.env.MONGODB_URL));async function n(){try{var o=l.readdirSync(t.join(__dirname,"files_to_upload"));if(0===o.length)console.warn("No files to upload");else{console.log("Connecting to MongoDB database..."),await c.connect(),console.log("Connected to MongoDB database!");var e=c.db("kantine").collection("inventory");console.log("Reading files...");for(const a of o)if(a.endsWith(".json")){var n=l.readFileSync(t.join(__dirname,"files_to_upload",a),{encoding:"utf8"});let o;try{o=JSON.parse(n)}catch(o){console.error("Error parsing JSON: "+a,o)}if(o){console.log("Uploading: "+a+"...");for(var[i,r]of Object.entries(o))try{await e.updateOne({id:parseInt(i)},{$inc:{quantity:r}})}catch(o){console.error(o)}console.log("Uploaded: "+a+"!")}}else console.warn("Skipping: "+a+" because of invalid filetype")}}catch(o){console.error(o)}finally{console.log("Finished!"),c.close()}}n();